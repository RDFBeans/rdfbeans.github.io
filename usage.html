<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2017-03-15 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170315" />
    <meta http-equiv="Content-Language" content="en" />
    <title>RDFBeans &#x2013; RDFBeans Usage Guide</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>RDFBeans</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2017-03-15
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 2.2-SNAPSHOT
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">RDFBeans</li>
                              
      <li>
  
                          <a href="index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Usage</a>
          </li>
                
      <li>
  
                          <a href="rdfbean.html" title="RDFBean format">
          <span class="none"></span>
        RDFBean format</a>
            </li>
                
      <li>
  
                          <a href="download.html" title="Download">
          <span class="none"></span>
        Download</a>
            </li>
                
      <li>
  
                          <a href="apidocs/index.html" title="JavaDocs">
          <span class="none"></span>
        JavaDocs</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                    
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>RDFBeans Usage Guide</h1>

<ul>
<li><a href="#Make_sure_that_your_Java_classes_or_interfaces_are_RDFBeans-compliant">Make sure that your Java classes or interfaces are RDFBeans-compliant</a></li>
<li><a href="#Add_required_RDFBeans_annotations">Add required RDFBeans annotations</a></li>
<li><a href="#Prepare_your_RDF_storage">Prepare your RDF storage</a></li>
<li><a href="#Go_with_RDFBeans">Go with RDFBeans</a></li>
<li><a href="#Adding_instances">Adding instances</a></li>
<li><a href="#Updating_instances">Updating instances</a></li>
<li><a href="#Retrieving_instances">Retrieving instances</a></li>
<li><a href="#Resolving_RDFBean_identifiers">Resolving RDFBean identifiers</a></li>
<li><a href="#Deleting_RDFBeans">Deleting RDFBeans</a></li>
<li><a href="#Cascade_databinding">Cascade databinding</a></li>
<li><a href="#Transactions">Transactions</a></li>
<li><a href="#Querying_the_model">Querying the model</a></li></ul>
<div class="section">
<h2><a name="Getting_started"></a>Getting started</h2>
<p>Persisting Java objects with RDF in your application requires few easy steps:</p>
<div class="section">
<h3><a name="Make_sure_that_your_Java_classes_or_interfaces_are_RDFBeans-compliant"></a>Make sure that your Java classes or interfaces are RDFBeans-compliant</h3>
<p>This basically means that every class or interface you intend to use within RDFBeans framework must obey general <a class="externalLink" href="http://en.wikipedia.org/wiki/JavaBean">JavaBeans conventions</a>: that is, the classes must have a public no-argument constructor and classes and interfaces must declare conventionally named getter and setter methods for the fields you plan to map to RDF properties. Serializability of the classes is not required.</p></div>
<div class="section">
<h3><a name="Add_required_RDFBeans_annotations"></a>Add required RDFBeans annotations</h3>
<p><i>RDFBean type declaration</i> (<tt>@RDFBean</tt>) declares that the class or interface is an RDFBean mapped to specified RDF type:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@RDFBean(&quot;http://xmlns.com/foaf/0.1/Person&quot;)
public class Person
{ ...
</pre></div></div>
<p><i>Property declarations</i> (<tt>@RDF</tt>) are applied to the getter methods of the data properties to declare their RDF counterparts:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@RDF(&quot;http://xmlns.com/foaf/0.1/name&quot;)
public String getName()
{ ...
</pre></div></div>
<p><i>Identifier property declaration</i> (<tt>@RDFSubject</tt>) is applied to a single getter method to mark that it returns an unique String value identifying an RDFBean instance.</p>
<p>Identifiers in RDF are URIs, so this method must either return a valid absolute URI, or a namespace prefix should be declared to construct the URI from the prefix value and the String, returned by the method:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@RDFSubject
public String getUri()
{ ... // -- must return absolute URI
</pre></div></div>
<p>or</p>

<div class="source">
<div class="source"><pre class="prettyprint">@RDFSubject(prefix=&quot;http://some.uri.prefix/&quot;)
public String getId()
{ ... // -- returns an arbitrary string
</pre></div></div>
<p>For complete specification of RDFBeans annotation conventions and examples, please refer to <a href="rdfbean.html">RDFBeans classes and interfaces format specification</a>.</p></div>
<div class="section">
<h3><a name="Prepare_your_RDF_storage"></a>Prepare your RDF storage</h3>
<p>Set up and configure an <a class="externalLink" href="http://semanticweb.org/wiki/RDF2Go">RDF2Go</a>-supported RDF framework (Sesame or Jena) as a back-end to store RDF representations of your RDFBeans classes.</p></div>
<div class="section">
<h3><a name="Go_with_RDFBeans"></a>Go with RDFBeans</h3>
<p>Add, retrieve, modify and delete your RDFBean objects using <tt>RDFBeanManager</tt> class and RDF2Go <a class="externalLink" href="http://mavenrepo.fzi.de/semweb4j.org/site/rdf2go.api/apidocs/org/ontoware/rdf2go/model/Model.html">Model</a> implementation, as it&#x2019;s shown below on this page.</p></div></div>
<div class="section">
<h2><a name="Classes_or_interfaces"></a>Classes or interfaces?</h2>
<p>Before you start, you need to decide which of two databinding techniques supported by RDFBeans framework to be used.</p>
<p>The first method is based on use of RDFBean classes and it is much more like a traditional JavaBeans persistence technique. Here you declare a RDFBean class with no-argument constructor, instantiate it and manipulate with properties data. At any time, you can dump (marshal) the object state to the RDF model and retrieve it from there.</p>
<p>The second method is based purely on the RDFBean interfaces. In this case, the special proxy objects are created dynamically to access the RDF data directly through RDFBean methods. Setting of a RDFBean property causes immediate update of the RDF model and the getter methods return actual values, retrieved from the model, so you don&#x2019;t have to bother about state synchronization between your object model and RDF resources.</p>
<p>It is completely up to you which one method you should use in your application. Moreover, it is perfectly ok to use both methods at the same time and on the same RDF model.</p></div>
<div class="section">
<h2><a name="RDFBeanManager"></a>RDFBeanManager</h2>
<p>RDFBeans databinding functions are accessible as methods of a single <tt>RDFBeanManager</tt> class. An <tt>RDFBeanManager</tt> instance is created with a RDF2Go <a class="externalLink" href="http://mavenrepo.fzi.de/semweb4j.org/site/rdf2go.api/apidocs/org/ontoware/rdf2go/model/Model.html">Model</a> which provides an abstraction layer to access an underlying physical RDF storage. Currently, <a class="externalLink" href="http://semanticweb.org/wiki/RDF2Go">RDF2Go</a> project provides implementations of Model interface (adapters) for Sesame 2.x and Jena frameworks.</p>
<p>A Model instance is passed as an argument to the <tt>RDFBeanManager</tt> constructor. The Model implementations may require the model to be opened (initialized) before and closed after use. The following example illustrates how to setup RDFBeans databinding with a model adapter determined automatically via RDF2Go ModelFactory mechanism:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import org.cyberborean.rdfbeans.RDFBeanManager;
import org.ontoware.rdf2go.ModelFactory;
import org.ontoware.rdf2go.RDF2Go;
import org.ontoware.rdf2go.model.Model;
...

ModelFactory modelFactory = RDF2Go.getModelFactory();
Model model = modelFactory.createModel();
model.open();
RDFBeanManager manager = new RDFBeanManager(model);
...
model.close();
</pre></div></div>
<p>An example with hardcoded Sesame 2.x NativeStore model implementation:</p>

<div class="source">
<div class="source"><pre class="prettyprint">import org.cyberborean.rdfbeans.RDFBeanManager;
import org.ontoware.rdf2go.model.Model;
import org.openrdf.rdf2go.RepositoryModel;
import org.openrdf.repository.Repository;
import org.openrdf.repository.sail.SailRepository;
import org.openrdf.sail.nativerdf.NativeStore;
...

Repository repository = new SailRepository(new NativeStore(new File(&quot;~/.sesame/test&quot;)));
repository.initialize();
Model model = new RepositoryModel(repository);
model.open();
RDFBeanManager manager = new RDFBeanManager(model);
...
model.close();
</pre></div></div>
<p>For detailed information on RDF2Go configuration for specific triple store adapters, please refer to <a class="externalLink" href="http://semanticweb.org/wiki/RDF2Go#Documentation_and_Tutorial">RDF2Go documentation</a>.</p></div>
<div class="section">
<h2><a name="Working_with_RDFBean_classes"></a>Working with RDFBean classes</h2>
<div class="section">
<h3><a name="Adding_instances"></a>Adding instances</h3>
<p>To add (marshall) a current state of an RDFBean object into the underlying RDF model, there is <tt>add()</tt> method:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Person person = new Person();
person.setId(&quot;http://example.com/persons/jdoe&quot;);
person.setName(&quot;John Doe&quot;);
...

Resource r = manager.add(person);
</pre></div></div>
<p>If the RDFBean is not anonymous (i.e. has a not-null property annotated with <tt>@RDFSubject</tt> - see <a href="rdfbean.html">RDFBean format</a>), the method returns <a class="externalLink" href="http://mavenrepo.fzi.de/semweb4j.org/site/rdf2go.api/apidocs/org/ontoware/rdf2go/model/node/Resource.html">org.ontoware.rdf2go.model.node.Resource</a> object, representing an URI of RDF resource created in the model. Otherwise, the Resource result represents a <a class="externalLink" href="http://mavenrepo.fzi.de/semweb4j.org/site/rdf2go.api/apidocs/org/ontoware/rdf2go/model/node/BlankNode.html">org.ontoware.rdf2go.model.node.BlankNode</a>  instance.</p></div>
<div class="section">
<h3><a name="Updating_instances"></a>Updating instances</h3>
<p><tt>update()</tt> method synchronizes the state of an RDFBean instance and the state of its RDF representation of in the model:</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
person.setEmail(&quot;john.doe@example.com&quot;);
Resource r = manager.update(person);
</pre></div></div>
<p>The code above sets new property of our Person instance and updates it in the RDF model, thus synchronizing the RDF resource with the actual object state. Note that this method works properly only with unanonymous RDFBeans - otherwise, it would insert another BlankNode into the model (i.e. has the same behaviour as <tt>add()</tt>).</p></div>
<div class="section">
<h3><a name="Retrieving_instances"></a>Retrieving instances</h3>
<p>RDFBean class instances can be retrieved (unmarshalled) from their RDF representations using <tt>get()</tt> method:</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
Person person2 = manager.get(&quot;http://example.com/persons/jdoe&quot;, Person.class);
</pre></div></div>
<p>This method returns new instance of specified RDFBean class filled with data retrieved from the RDF model.</p>
<p>In the example above, we assume that the RDFBean identifier has been declared without namespace prefix. Otherwise, we would have to pass only the local part of the identifier URI as an argument:</p>

<div class="source">
<div class="source"><pre class="prettyprint">... // assuming 'http://example.com/persons/' is a prefix
Person person2 = manager.get(&quot;jdoe&quot;, Person.class);
</pre></div></div>
<p>The <tt>get()</tt> method returns <tt>null</tt> if no RDF resource matching the given RDFBean identifier and class is found.</p>
<p>If we already have an RDF resource URI or a BlankNode (returned by <tt>add()</tt> or <tt>update()</tt> methods for instance), we can retrive the matching RDFBean instance using that value:</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
Person person2 = (Person) manager.get(r);
</pre></div></div>
<p>The <tt>getAll()</tt> method iterates over all RDFBeans of a specified class in the model:</p>

<div class="source">
<div class="source"><pre class="prettyprint">// Displays the names of all Persons in the model:
ClosableIterator iter = manager.getAll(Person.class);
while (iter.hasNext()) {
   Person p = (Person)iter.next();
   System.out.println(p.getName());
}
iter.close();
</pre></div></div></div></div>
<div class="section">
<h2><a name="Working_with_RDFBean_interfaces"></a>Working with RDFBean interfaces</h2>
<p>This is an alternative mapping technique which is based on using RDFBean interfaces and dynamic proxy objects.</p>
<p>Let&#x2019;s extract the interface from our RDFBean <tt>Person</tt> class and annotate it the same way:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@RDFBean(&quot;http://xmlns.com/foaf/0.1/Person&quot;)
public interface IPerson {

    @RDFSubject
    String getId();

    @RDF(&quot;http://xmlns.com/foaf/0.1/name&quot;)
    String getName();

    ...
</pre></div></div>
<p>As we have this interface, we can map it directly to an RDF resource in the model. For that, we need to obtain an instance of the dynamic proxy object from RDFBeanManager:</p>

<div class="source">
<div class="source"><pre class="prettyprint">IPerson person = manager.create(&quot;http://example.com/persons/jdoe&quot;, IPerson.class);
</pre></div></div>
<p>The <tt>create()</tt> method returns an object implementing our <tt>IPerson</tt> interface and matching the RDFBean with the specified identifier in the model. This proxy object has the same behaviour as an instance of the class implementing that interface, with the exception that all its data is stored not in the Java heap, but directly in the underlying RDF model. So, the call:</p>

<div class="source">
<div class="source"><pre class="prettyprint">person.setName(&quot;John Doe&quot;);
</pre></div></div>
<p>will cause a statement with RDF property <tt>http://xmlns.com/foaf/0.1/name</tt> and the given literal value to be created or updated in the model. Similarly, the <tt>getName()</tt> method of the proxy would return this value addressing directly to that statement.</p>
<p>If no resource matching the specified RDFBean identifier exists in the model, <tt>create()</tt> returns an empty instance, that is all its <tt>getXXX()</tt> methods return nulls. The underlying RDF model will be unchanged until the first <tt>setXXX()</tt> method is called.</p>
<p>To instantiate the proxy objects for existing RDFBeans, the <tt>create()</tt> method with a Resource argument can be used. The method returns null if the specified Resource doesn&#x2019;t exist in the model:</p>

<div class="source">
<div class="source"><pre class="prettyprint">IPerson person = manager.create(r);
</pre></div></div>
<p>The reference to the Resource can be obtained with <tt>getResource()</tt> method (see {Resolving RDFBean identifiers} below), or by querying the underlying RDF model (see Querying the model).</p></div>
<div class="section">
<h2><a name="Managing_RDFBeans_in_the_model"></a>Managing RDFBeans in the model</h2>
<div class="section">
<h3><a name="Resolving_RDFBean_identifiers"></a>Resolving RDFBean identifiers</h3>
<p>If an RDFBean identifier is known, it can be resolved to an RDF resource using the identifier&#x2019;s String value and RDFBean class:</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
Resource r = manager.getResource(&quot;http://example.com/persons/jdoe&quot;, Person.class);
</pre></div></div>
<p>or, if a namespace prefix is set for identifiers:</p>

<div class="source">
<div class="source"><pre class="prettyprint">... // assuming 'http://example.com/persons/' is a prefix
Resource r = manager.getResource(&quot;jdoe&quot;, Person.class);
</pre></div></div>
<p>The method returns null if no matching Resource is found in the model.</p></div>
<div class="section">
<h3><a name="Deleting_RDFBeans"></a>Deleting RDFBeans</h3>
<p>RDFBean representation can be deleted from RDF model with <tt>delete()</tt> method:</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
manager.delete(&quot;http://example.com/persons/jdoe&quot;, Person.class);
</pre></div></div>
<p>or</p>

<div class="source">
<div class="source"><pre class="prettyprint">...
Resource r = manager.getResource(&quot;http://example.com/persons/jdoe&quot;, Person.class);
if (r != null) {
    manager.delete(r);
}
</pre></div></div></div></div>
<div class="section">
<h2><a name="Advanced_topics"></a>Advanced topics</h2>
<div class="section">
<h3><a name="Cascade_databinding"></a>Cascade databinding</h3>
<p><tt>add()</tt> and <tt>update()</tt> methods performs cascade databinding, that is if a marshalling object has other RDFBeans as its properties, they are marshalled and added to the model recursively. It allows to manipulate with the whole complex object models with single method calls.</p>
<p>For example, let the <tt>Person</tt> class declares a <tt>knows</tt> property (probably, mapped to <tt>foaf:knows</tt>) to link Persons one another (for simplicity, put cardinality of this property to 1):</p>

<div class="source">
<div class="source"><pre class="prettyprint">Person john = new Person();
john.setId(&quot;http://example.com/persons/john&quot;);
...
Person mary = new Person();
mary.setId(&quot;http://example.com/persons/mary&quot;);
...
john.setKnows(mary);
</pre></div></div>
<p>Calling <tt>manager.add(john)</tt> will result in adding both objects (<tt>john</tt> and <tt>mary</tt>) and generating a statement to relate their RDF representations with the <tt>knows</tt> property.</p>
<p>Similarly, on retrieving the <tt>john</tt> object, the <tt>mary</tt> RDFBean will be automatically unmarshalled and assigned to <tt>john.knows</tt> property, thus reconstructing the whole graph of related objects.</p>
<p>The dynamic proxies follow the same principle: when a getter method is called and the property references to another RDFBean, the proxy object is automatically created and returned:</p>

<div class="source">
<div class="source"><pre class="prettyprint">IPerson john = manager.create(&quot;http://example.com/persons/john&quot;, IPerson.class);
IPerson mary = manager.create(&quot;http://example.com/persons/mary&quot;, IPerson.class);
john.setKnows(mary);
...
john.getKnows().setName(&quot;Mary&quot;); // getKnows() returns the proxy equals to mary
System.out.println(mary.getName()); // -- will be &quot;Mary&quot;
</pre></div></div></div>
<div class="section">
<h3><a name="Transactions"></a>Transactions</h3>
<p>By default, each call of <tt>add()</tt>, <tt>update()</tt> or <tt>delete()</tt> methods will commit the transaction into a RDF store after an operation is completed. This behaviour can be changed by setting the autocommit mode to false with <tt>setAutocommit()</tt> method. If autocommit is off, the transactions can be commited by explicit calling of the <tt>commit()</tt> method of a underlying RDF2Go Model interface:</p>

<div class="source">
<div class="source"><pre class="prettyprint">// Adding multiple RDFBeans as a single transaction:
manager.setAutocommit(false);
for (Person p: persons) {
  manager.add(p);
}
manager.getModel().commit();
</pre></div></div>
<p>Note that the autocommit mode in RDFBeanManager is unrelated to the autocommit settings of the underlying model. RDFBeanManager operations always set the autocommit flag of the model to false to avoid commiting every single RDF triple.</p>
<p>If dynamic proxies are used and autocommit mode is on, every setter method call will commit a transaction. You can turn the autocommit off for manual transaction management:</p>

<div class="source">
<div class="source"><pre class="prettyprint">manager.setAutocommit(false);
IPerson john = manager.create(&quot;http://example.com/persons/john&quot;, IPerson.class);
john.setName(&quot;John&quot;);
System.out.println(john.getName()); // -- will be null
manager.getModel().commit();
System.out.println(john.getName()); // -- and now it is &quot;John&quot;
</pre></div></div></div>
<div class="section">
<h3><a name="Querying_the_model"></a>Querying the model</h3>
<p>RDFBeans framework does not include its own facilities to query the RDF model, but it is possible to query the underlying RDF2Go model and retrieve RDFBean objects from results.</p>
<p>Example of querying with the triple patterns:</p>

<div class="source">
<div class="source"><pre class="prettyprint">// Find all persons with Google as a workplace homepage:

Set&lt;Person&gt; results = new HashSet&lt;Person&gt;();
URI predicate = model.createURI(&quot;http://xmlns.com/foaf/0.1/workplaceHomepage&quot;);
URI object = model.createURI(&quot;http://google.com&quot;);
ClosableIterator&lt;Statement&gt; ci = model.findStatements(Variable.ANY, predicate, object);
while (ci.hasNext()) {
  Resource r = ci.next().getSubject();
  results.add((Person)manager.get(r));
}
ci.close();
</pre></div></div>
<p>Example of using Sparql:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Set&lt;Person&gt; results = new HashSet&lt;Person&gt;();
ClosableIterator&lt;QueryRow&gt; ci = model.sparqlSelect(
  &quot;SELECT ?r WHERE { ?r &lt;http://xmlns.com/foaf/0.1/workplaceHomepage&gt; &lt;http://google.com&gt; . }&quot;
).iterator();
while (ci.hasNext()) {
  Resource r = ci.next().getValue(&quot;r&quot;).asResource();
  results.add((Person)manager.get(r));
}
ci.close();
</pre></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2017.
          All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
